{"version":3,"sources":["common-async.5496443382647786649.hot-update.js","src/Dialog/index.tsx"],"sourcesContent":["globalThis.makoModuleHotUpdate(\n  'common',\n  {\n    modules: {},\n  },\n  function (runtime) {\n    runtime._h='10574679623745077797';\nruntime.updateEnsure2Map({\".dumi/tmp/dumi/theme/ContextWrapper.tsx\":[\"dumi__tmp__dumi__theme__ContextWrapper\"],\"docs/changelog.md\":[\"vendors\",\"docs/changelog.md\"],\"docs/changelog.md?type=demo\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/changelog.md?type=text\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/demo/ant-design.md\":[\"vendors\",\"docs/demo/ant-design.md\"],\"docs/demo/ant-design.md?type=demo\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/demo/ant-design.md?type=text\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/demo/bootstrap.md\":[\"vendors\",\"docs/demo/bootstrap.md\"],\"docs/demo/bootstrap.md?type=demo\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/demo/bootstrap.md?type=text\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/demo/draggable.md\":[\"vendors\",\"docs/demo/draggable.md\"],\"docs/demo/draggable.md?type=demo\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/demo/draggable.md?type=text\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/demo/multiple-Portal.md\":[\"vendors\",\"docs/demo/multiple-Portal.md\"],\"docs/demo/multiple-Portal.md?type=demo\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/demo/multiple-Portal.md?type=text\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/demo/pure.md\":[\"vendors\",\"docs/demo/pure.md\"],\"docs/demo/pure.md?type=demo\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/demo/pure.md?type=text\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/examples/ant-design.tsx?techStack=react\":[\"vendors\",\"common\",\"demos\"],\"docs/examples/bootstrap.tsx?techStack=react\":[\"vendors\",\"common\",\"demos\"],\"docs/examples/draggable.tsx?techStack=react\":[\"vendors\",\"common\",\"demos\"],\"docs/examples/multiple-Portal.tsx?techStack=react\":[\"vendors\",\"common\",\"demos\"],\"docs/examples/pure.tsx?techStack=react\":[\"vendors\",\"common\",\"demos\"],\"docs/index.md\":[\"vendors\",\"docs/index.md\"],\"docs/index.md?type=demo\":[\"vendors\",\"common\",\"meta__docs\"],\"docs/index.md?type=text\":[\"vendors\",\"common\",\"meta__docs\"],\"node_modules/_dumi@2.4.17@dumi/dist/client/misc/reactDemoCompiler.js\":[\"vendors\",\"node_modules/_dumi@2.4.17@dumi/dist/client/misc/reactDemoCompiler.js\"],\"node_modules/_dumi@2.4.17@dumi/dist/client/pages/404.js\":[\"vendors\",\"nm__dumi__dist__client__pages__404\"],\"node_modules/_dumi@2.4.17@dumi/dist/client/pages/Demo/index.js\":[\"vendors\",\"nm__dumi__dist__client__pages__Demo__index\"],\"node_modules/_dumi@2.4.17@dumi/theme-default/layouts/DocLayout/index.js\":[\"vendors\",\"node_modules/_dumi@2.4.17@dumi/theme-default/layouts/DocLayout/index.js\"],\"node_modules/_react-dom@18.3.1@react-dom/server.browser.js\":[\"vendors\",\"node_modules/_react-dom@18.3.1@react-dom/server.browser.js\"]});;\n  },\n);\n","import classNames from 'classnames';\nimport contains from '@rc-component/util/lib/Dom/contains';\nimport useId from '@rc-component/util/lib/hooks/useId';\nimport KeyCode from '@rc-component/util/lib/KeyCode';\nimport pickAttrs from '@rc-component/util/lib/pickAttrs';\nimport * as React from 'react';\nimport { useEffect, useRef } from 'react';\nimport type { IDialogPropTypes } from '../IDialogPropTypes';\nimport { getMotionName } from '../util';\nimport Content, { type ContentRef } from './Content';\nimport Mask from './Mask';\nimport { warning } from '@rc-component/util/lib/warning';\n\nconst Dialog: React.FC<IDialogPropTypes> = (props) => {\n  const {\n    prefixCls = 'rc-dialog',\n    zIndex,\n    visible = false,\n    keyboard = true,\n    focusTriggerAfterClose = true,\n    // scrollLocker,\n    // Wrapper\n    wrapStyle,\n    wrapClassName,\n    wrapProps,\n    onClose,\n    afterOpenChange,\n    afterClose,\n\n    // Dialog\n    transitionName,\n    animation,\n    closable = true,\n\n    // Mask\n    mask = true,\n    maskTransitionName,\n    maskAnimation,\n    maskClosable = true,\n    maskStyle,\n    maskProps,\n    rootClassName,\n    rootStyle,\n    classNames: modalClassNames,\n    styles: modalStyles,\n  } = props;\n\n  if (process.env.NODE_ENV !== 'production') {\n    ['wrapStyle', 'bodyStyle', 'maskStyle'].forEach((prop) => {\n      // (prop in props) && console.error(`Warning: ${prop} is deprecated, please use styles instead.`)\n      warning(!(prop in props), `${prop} is deprecated, please use styles instead.`);\n    });\n    if ('wrapClassName' in props) {\n      warning(false, `wrapClassName is deprecated, please use classNames instead.`);\n    }\n  }\n\n  const lastOutSideActiveElementRef = useRef<HTMLElement>();\n  const wrapperRef = useRef<HTMLDivElement>();\n  const contentRef = useRef<ContentRef>();\n\n  const [animatedVisible, setAnimatedVisible] = React.useState(visible);\n\n  // ========================== Init ==========================\n  const ariaId = useId();\n\n  function saveLastOutSideActiveElementRef() {\n    if (!contains(wrapperRef.current, document.activeElement)) {\n      lastOutSideActiveElementRef.current = document.activeElement as HTMLElement;\n    }\n  }\n\n  function focusDialogContent() {\n    if (!contains(wrapperRef.current, document.activeElement)) {\n      contentRef.current?.focus();\n    }\n  }\n\n  // ========================= Events =========================\n  // Close action will trigger by:\n  //   1. When hide motion end\n  //   2. Controlled `open` to `false` immediately after set to `true` which will not trigger motion\n  function doClose() {\n    // Clean up scroll bar & focus back\n    setAnimatedVisible(false);\n\n    if (mask && lastOutSideActiveElementRef.current && focusTriggerAfterClose) {\n      try {\n        lastOutSideActiveElementRef.current.focus({ preventScroll: true });\n      } catch (e) {\n        // Do nothing\n      }\n      lastOutSideActiveElementRef.current = null;\n    }\n\n    // Trigger afterClose only when change visible from true to false\n    if (animatedVisible) {\n      afterClose?.();\n    }\n  }\n\n  function onDialogVisibleChanged(newVisible: boolean) {\n    // Try to focus\n    if (newVisible) {\n      focusDialogContent();\n    } else {\n      doClose();\n    }\n    afterOpenChange?.(newVisible);\n  }\n\n  function onInternalClose(e: React.SyntheticEvent) {\n    onClose?.(e);\n  }\n\n  // >>> Content\n  const contentClickRef = useRef(false);\n  const contentTimeoutRef = useRef<ReturnType<typeof setTimeout>>();\n\n  // We need record content click incase content popup out of dialog\n  const onContentMouseDown: React.MouseEventHandler = () => {\n    clearTimeout(contentTimeoutRef.current);\n    contentClickRef.current = true;\n  };\n\n  const onContentMouseUp: React.MouseEventHandler = () => {\n    contentTimeoutRef.current = setTimeout(() => {\n      contentClickRef.current = false;\n    });\n  };\n\n  // >>> Wrapper\n  // Close only when element not on dialog\n  let onWrapperClick: (e: React.SyntheticEvent) => void = null;\n  if (maskClosable) {\n    onWrapperClick = (e) => {\n      if (contentClickRef.current) {\n        contentClickRef.current = false;\n      } else if (wrapperRef.current === e.target) {\n        onInternalClose(e);\n      }\n    };\n  }\n\n  function onWrapperKeyDown(e: React.KeyboardEvent<HTMLDivElement>) {\n    if (keyboard && e.keyCode === KeyCode.ESC) {\n      e.stopPropagation();\n      onInternalClose(e);\n      return;\n    }\n\n    // keep focus inside dialog\n    if (visible && e.keyCode === KeyCode.TAB) {\n      contentRef.current.changeActive(!e.shiftKey);\n    }\n  }\n\n  // ========================= Effect =========================\n  useEffect(() => {\n    if (visible) {\n      setAnimatedVisible(true);\n      saveLastOutSideActiveElementRef();\n    } else if (\n      animatedVisible &&\n      contentRef.current.enableMotion() &&\n      !contentRef.current.inMotion()\n    ) {\n      doClose();\n    }\n  }, [visible]);\n\n  // Remove direct should also check the scroll bar update\n  useEffect(\n    () => () => {\n      clearTimeout(contentTimeoutRef.current);\n    },\n    [],\n  );\n\n  const mergedStyle: React.CSSProperties = {\n    zIndex,\n    ...wrapStyle,\n    ...modalStyles?.wrapper,\n    display: !animatedVisible ? 'none' : null,\n  };\n\n  // ========================= Render =========================\n  return (\n    <div\n      className={classNames(`${prefixCls}-root`, rootClassName)}\n      style={rootStyle}\n      {...pickAttrs(props, { data: true })}\n    >\n      <Mask\n        prefixCls={prefixCls}\n        visible={mask && visible}\n        motionName={getMotionName(prefixCls, maskTransitionName, maskAnimation)}\n        style={{ zIndex, ...maskStyle, ...modalStyles?.mask }}\n        maskProps={maskProps}\n        className={modalClassNames?.mask}\n      />\n      <div\n        tabIndex={-1}\n        onKeyDown={onWrapperKeyDown}\n        className={classNames(`${prefixCls}-wrap`, wrapClassName, modalClassNames?.wrapper)}\n        ref={wrapperRef}\n        onClick={onWrapperClick}\n        style={mergedStyle}\n        {...wrapProps}\n      >\n        <Content\n          {...props}\n          onMouseDown={onContentMouseDown}\n          onMouseUp={onContentMouseUp}\n          ref={contentRef}\n          closable={closable}\n          ariaId={ariaId}\n          prefixCls={prefixCls}\n          visible={visible && animatedVisible}\n          onClose={onInternalClose}\n          onVisibleChanged={onDialogVisibleChanged}\n          motionName={getMotionName(prefixCls, transitionName, animation)}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default Dialog;\n"],"names":[],"mappings":"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"}